<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.1">Jekyll</generator><link href="https://jeroenmols.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://jeroenmols.com/" rel="alternate" type="text/html" /><updated>2019-02-20T20:45:51+01:00</updated><id>https://jeroenmols.com/</id><title type="html">Jeroen Mols</title><subtitle>Blog and portfolio of Jeroen Mols, the Android developer you should hire.</subtitle><author><name>Jeroen Mols</name></author><entry><title type="html">Five tips to get your code base in shape</title><link href="https://jeroenmols.com/blog/2019/02/20/tacklelegacy/" rel="alternate" type="text/html" title="Five tips to get your code base in shape" /><published>2019-02-20T00:00:00+01:00</published><updated>2019-02-20T00:00:00+01:00</updated><id>https://jeroenmols.com/blog/2019/02/20/tacklelegacy</id><content type="html" xml:base="https://jeroenmols.com/blog/2019/02/20/tacklelegacy/">&lt;p&gt;Are you living the dream? Is your code so clean it makes your eyes just tear a little? Can‚Äôt think of anything you would still like to refactor? Never have any bugs? Using all the latest technologies?&lt;/p&gt;

&lt;p&gt;Unfortunately, most of us aren‚Äôt in this state. We have bugs that haunt us, crashes at inconvenient times and sometimes üí© simply hits the fan‚Ä¶ So how on earth do you get out of this mess?&lt;/p&gt;

&lt;p&gt;Well, I‚Äôm glad you ask! Here are five tips to get started.&lt;/p&gt;

&lt;h2 id=&quot;1-dont-rewrite&quot;&gt;1. Don‚Äôt rewrite&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;If only we could rewrite all of the code, we would be out of this mess in no time;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Remember that every project was a green field once, right? So why is it that all of us seem to end up in a similar state? Do you really think the previous developers didn‚Äôt have the best intentions?&lt;/p&gt;

&lt;p&gt;In reality rewrites hardly ever work out. Mainly because the complexity (corner cases) and required effort (amount of features) to rewrite everything gets underestimated. Hence rewriting will be incredibly time-consuming.&lt;/p&gt;

&lt;p&gt;At the same time, rewrites don‚Äôt focus on maximizing user value: you‚Äôll lose tons of time rewriting stuff that wasn‚Äôt problematic to begin with and users won‚Äôt get any new features until the rewrite is done.&lt;/p&gt;

&lt;p&gt;And technology isn‚Äôt standing still either: two years ago we didn‚Äôt have Kotlin, Jetpack, Architecture components, Navigation components,‚Ä¶ And that‚Äôs just the official Google stuff!&lt;/p&gt;

&lt;p&gt;With deadlines slipping, users complaining (no new features) and competition catching up‚Ä¶ will you really be able to resist not taking any shortcuts? Can you really guarantee you‚Äôll be better off?&lt;/p&gt;

&lt;p&gt;I‚Äôm not saying rewrites never work out, but they are certainly one of the riskiest approaches to getting rid of your legacy. If you‚Äôre rewriting your app, you are basically developing a new product that just happens to have the same feature set as the old app. (with all risks involved in new product development)&lt;/p&gt;

&lt;p&gt;Read more about challenges while rewriting by &lt;a href=&quot;http://chadfowler.com/2006/12/27/the-big-rewrite.html&quot;&gt;Chad Fowler&lt;/a&gt;, &lt;a href=&quot;https://www.joelonsoftware.com/2000/04/06/things-you-should-never-do-part-i/&quot;&gt;Joel Spolsky&lt;/a&gt;, &lt;a href=&quot;https://blog.intracto.com/paying-technical-debt-how-to-rescue-legacy-code-through-refactoring&quot;&gt;Jeroen Moons&lt;/a&gt; or &lt;a href=&quot;https://jvaneyck.wordpress.com/2015/03/12/the-big-rewrite/&quot;&gt;Jo Van Eyck&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;2-release-release-release&quot;&gt;2. Release, release, release&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;If it hurts, do it more often; Jez Humble&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;One thing that all legacy code has in common is that it‚Äôs poorly tested. Hence it can be very hard to control the impact of code changes.&lt;/p&gt;

&lt;p&gt;Ever been in the situation where a simple code clean up, suddenly broke a seemingly unrelated feature elsewhere in the app?&lt;/p&gt;

&lt;p&gt;Or maybe you wanted to release a new update to the field, but your test team just kept on finding issues? Causing release candidate to be created after release candidate?&lt;/p&gt;

&lt;p&gt;Such a lack of control over regression, unfortunately, isn‚Äôt uncommon. And while your natural instinct might be to just test each release longer manually, that just creates different problems:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;slower time to market due to longer test cycles&lt;/li&gt;
  &lt;li&gt;decreased release frequency due to more test overhead&lt;/li&gt;
  &lt;li&gt;harder to fix bugs, because they are found later&lt;/li&gt;
  &lt;li&gt;more overhead with Git branches (where does this fix go?)&lt;/li&gt;
  &lt;li&gt;working on several releases in parallel&lt;/li&gt;
  &lt;li&gt;frustrated testers&lt;/li&gt;
  &lt;li&gt;‚Ä¶&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The problem here is that you‚Äôre actually fundamentally accepting you don‚Äôt trust your app anymore. You start to rely on release testing to find bugs, implicitly taking away the responsibility from developers to not break things.&lt;/p&gt;

&lt;p&gt;Counterintuitively, however, you should release more often instead of less.&lt;/p&gt;

&lt;p&gt;Having smaller releases increases awareness of what changes were made in each release. Hence bugs can be easily tracked back to code changes and testing can be better focussed on the parts changed.&lt;/p&gt;

&lt;p&gt;Also having fewer lines of code changed in every release will simply cause fewer bugs to be introduced. And the more often you do something, the better you‚Äôll become at doing it.&lt;/p&gt;

&lt;p&gt;Finally, developers will get feedback faster as their code ends up in production sooner. That makes them more accountable, causing quality to go up.&lt;/p&gt;

&lt;p&gt;At Philips Hue, we now release every two weeks and it has gotten so normal that we barely think about it.&lt;/p&gt;

&lt;h2 id=&quot;3-divide-and-conquer&quot;&gt;3. Divide and conquer&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;It‚Äôs easier to build several smaller things than to build one big thing;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;While most developers tend to like spaghetti, they aren‚Äôt quite as fond of spaghetti code. This is because, in a spaghetti codebase, everything is connected to everything else.&lt;/p&gt;

&lt;p&gt;This has several challenges:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;changing things is hard: one small clean up leads to changes in another file, requiring changes somewhere else, cascading into a world of pain.&lt;/li&gt;
  &lt;li&gt;making changes in one place has unintended side effects&lt;/li&gt;
  &lt;li&gt;difficult to introduce new technologies (e.g. RXJava)&lt;/li&gt;
  &lt;li&gt;hard to scale up team: developers will often change the same files causing a lot of merge conflicts&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;What you are really missing, in this case, is having clearly defined contracts between different parts of your code. Instead, the implementation of several parts is tightly coupled together.&lt;/p&gt;

&lt;p&gt;So why don‚Äôt you split your big monolith in several, fully decoupled feature modules? This doesn‚Äôt just speed up builds, allow you to do instant apps, but it also allows to aggressively improve your app.&lt;/p&gt;

&lt;p&gt;Once you split a feature off, the rest of the app becomes completely agnostic of the internal implementation of such a feature, which means you can:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;either refactor the feature&lt;/li&gt;
  &lt;li&gt;fully rewrite the feature&lt;/li&gt;
  &lt;li&gt;or leave the feature as-is (not a problem to solve now)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This allows you to quickly and aggressively get your app into good shape, focussing on those parts that need attention most. In that way, even rewriting parts of your app suddenly becomes possible as you can derisk their roll-out with a feature toggle!&lt;/p&gt;

&lt;h2 id=&quot;4-master-your-tools&quot;&gt;4. Master your tools&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;The right tools for the right Job;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;If you read any &lt;a href=&quot;https://www.amazon.com/gp/product/0131177052/ref=as_li_tl?ie=UTF8&amp;amp;camp=1789&amp;amp;creative=9325&amp;amp;creativeASIN=0131177052&amp;amp;linkCode=as2&amp;amp;tag=jrnmls-20&amp;amp;linkId=e757dc2fcc803f637c8cd5c3d89c281e&quot;&gt;book on refactoring&lt;/a&gt;, you‚Äôll quickly learn that one of the main prerequisites of it is to have proper tests in place. But as mentioned above, legacy code usually either has no tests or is poorly tested.&lt;/p&gt;

&lt;p&gt;Now I don‚Äôt really want to dive into any particular refactoring strategies here, but a great way to reduce regression while refactoring is to automate as much of the process as possible.&lt;/p&gt;

&lt;p&gt;By this time I hope nobody renames classes by hand anymore? (e.g. rename class, rename constructors, rename file,‚Ä¶) But did you also know Android studio can also move code, extract methods, inline interfaces,‚Ä¶?&lt;/p&gt;

&lt;p&gt;Really really powerful stuff there. And it doesn‚Äôt just reduce regression, it also removes a lot of dull repetitive work from your plate allowing you to focus on the interesting challenges.&lt;/p&gt;

&lt;p&gt;I can help you get started with posts on &lt;a href=&quot;/blog/2018/02/22/androidstudioshortcuts/&quot;&gt;code navigation&lt;/a&gt; and &lt;a href=&quot;/blog/2018/04/26/androidstudioshortcuts2/&quot;&gt;refactoring&lt;/a&gt; in Android Studio.&lt;/p&gt;

&lt;h2 id=&quot;5-have-faith&quot;&gt;5. Have faith&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;We choose to go to the Moon, not because it is easy, but because it is hard; JFK&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Incrementally refactoring your app and rewriting parts of it isn‚Äôt going to be easy. It definitely won‚Äôt be a walk in the park.&lt;/p&gt;

&lt;p&gt;Especially refactoring can easily leave you unfulfilled: If you clean up the code in different places, it can easily feel insignificant, like your work barely made a dent in the bigger picture.&lt;/p&gt;

&lt;p&gt;Please know that you are not alone. The age of small apps is behind us for quite some time now. And software often looks deceptively simple, yet can be extremely hard.&lt;/p&gt;

&lt;p&gt;Bear with us, you‚Äôll manage. Even if you fail a few times along the way, at least you are trying (and learning!). There is light at the end of the tunnel, things will go better if you persist, one step at a time.&lt;/p&gt;

&lt;p&gt;Finally, know that you are learning an invaluable skill: maintaining software whilst improving and building further upon it. Trust me, these refactoring skills will prove to be invaluable for the rest of your career.&lt;/p&gt;

&lt;h2 id=&quot;wrap-up&quot;&gt;Wrap-up&lt;/h2&gt;
&lt;p&gt;There is no silver bullet to magically improve your code base, especially not rewriting. But by learning your tools, slicing your app in several modules and releasing often you will succeed if you have faith.&lt;/p&gt;

&lt;p&gt;If you‚Äôve made it this far you should probably follow me on &lt;span&gt;&lt;a href=&quot;https://twitter.com/molsjeroen?source=fivetipstogetyourcodebaseinshape2019&quot; class=&quot;ga-link&quot; target=&quot;_blank&quot;&gt;Twitter&lt;/a&gt;&lt;/span&gt;
. Feel free leave a comment below!&lt;/p&gt;

&lt;h2 id=&quot;further-reads&quot;&gt;Further reads&lt;/h2&gt;
&lt;p&gt;If I‚Äôve piqued your interest and you would like to learn more, I can highly recommend the following books:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.amazon.com/gp/product/0131177052/ref=as_li_tl?ie=UTF8&amp;amp;camp=1789&amp;amp;creative=9325&amp;amp;creativeASIN=0131177052&amp;amp;linkCode=as2&amp;amp;tag=jrnmls-20&amp;amp;linkId=e757dc2fcc803f637c8cd5c3d89c281e&quot;&gt;Working effectively with legacy code&lt;/a&gt; by Michael Feathers: Excellent book on how to refactor legacy code with amazing chapter names like ‚ÄúI Don‚Äôt Have Much Time and I Have to Change It‚Äù and ‚ÄúI Need to Make a Change, but I Don‚Äôt Know What Tests to Write‚Äù&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.amazon.com/gp/product/0321601912/ref=as_li_tl?ie=UTF8&amp;amp;camp=1789&amp;amp;creative=9325&amp;amp;creativeASIN=0321601912&amp;amp;linkCode=as2&amp;amp;tag=jrnmls-20&amp;amp;linkId=6118692c28efd4239f6e14c430bbd871&quot;&gt;Continuous Delivery: Reliable Software Releases Through Build, Test, and Deployment Automation&lt;/a&gt; by Jez Humble and David Farley: Great book if you‚Äôd like to learn more about continuous delivery and what the benefits could be for your team/organization.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.amazon.com/gp/product/0321146530/ref=as_li_tl?ie=UTF8&amp;amp;camp=1789&amp;amp;creative=9325&amp;amp;creativeASIN=0321146530&amp;amp;linkCode=as2&amp;amp;tag=jrnmls-20&amp;amp;linkId=b785589aa73d26e7dcddfb1a1d70d3d0&quot;&gt;Test Driven Development: By Example&lt;/a&gt; by Kent Beck: While tackling legacy code, writing automated tests is of the utmost importance. This book provides a really nice introduction to test-driven development from its inventor Kent Beck.&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Jeroen Mols</name></author><category term="refactoring" /><category term="architecture" /><category term="software engineering" /><summary type="html">Are you living the dream? Is your code so clean it makes your eyes just tear a little? Can‚Äôt think of anything you would still like to refactor? Never have any bugs? Using all the latest technologies?</summary></entry><entry><title type="html">Testing LiveData in JUnit 4 and JUnit 5</title><link href="https://jeroenmols.com/blog/2019/01/17/livedatajunit5/" rel="alternate" type="text/html" title="Testing LiveData in JUnit 4 and JUnit 5" /><published>2019-01-17T00:00:00+01:00</published><updated>2019-01-17T00:00:00+01:00</updated><id>https://jeroenmols.com/blog/2019/01/17/livedatajunit5</id><content type="html" xml:base="https://jeroenmols.com/blog/2019/01/17/livedatajunit5/">&lt;p&gt;Architecture components are one of the most exciting things that happened to Android in the past years. But how do you effectively go about and testing this?&lt;/p&gt;

&lt;h2 id=&quot;problem-statement&quot;&gt;Problem statement&lt;/h2&gt;
&lt;p&gt;One of the interesting problems LiveData solves is to ensure the observer is always called on the main thread. This happens in the following ways:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;setValue()&lt;/code&gt;: crashes if not called from main thread&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;postValue()&lt;/code&gt;: swaps to main thread and is safe to be called from any background thread&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Now what happens if you call any of these methods in a junit test?&lt;/p&gt;

&lt;p&gt;When calling &lt;code class=&quot;highlighter-rouge&quot;&gt;livedata.setValue()&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;livedata.value =&lt;/code&gt; you get:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;java.lang.RuntimeException:
Method getMainLooper in android.os.Looper not mocked.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Or alternatively when &lt;code class=&quot;highlighter-rouge&quot;&gt;unitTests.returnDefaultValues = true&lt;/code&gt; is on:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;java.lang.NullPointerException
at androidx.arch.core.executor.DefaultTaskExecutor.isMainThread(DefaultTaskExecutor.java:74)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This makes sense, because JVM unit tests don‚Äôt know anything about the Android main thread! Hence all unit test are executed on a random (background) thread.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Note that this is true in general. The main Thread is just a concept provided by most UI frameworks to avoid race conditions while updating the UI. E.g. on Android the main thread is provided by the Android Framework, for Java applications the main thread is provided by Swing (for instance).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;When calling &lt;code class=&quot;highlighter-rouge&quot;&gt;livedata.postValue()&lt;/code&gt;, you get similar results.&lt;/p&gt;

&lt;p&gt;However here the problem is even more fundamental as this can never work. Even if the main thread would exist in the test, then the actual value update would happen asynchronously from the test, causing the asserts to happen before the value is actually updated.&lt;/p&gt;

&lt;h2 id=&quot;junit-4&quot;&gt;JUnit 4&lt;/h2&gt;
&lt;p&gt;Solving this means doing two things:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;don‚Äôt update live data on the main thread&lt;/li&gt;
  &lt;li&gt;update live data immediately (don‚Äôt post value)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Fortunately the architecture components team has provided a JUnit rule to do exactly that:&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ExampleUnitTest&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;@get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Rule&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;rule&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InstantTaskExecutorRule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;mutableLiveData&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MutableLiveData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;()&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;mutableLiveData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;postValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mutableLiveData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;All you have to do is add a &lt;code class=&quot;highlighter-rouge&quot;&gt;InstantTaskExecutorRule()&lt;/code&gt; to the class containing ViewModel and add the following Gradle dependency:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;dependencies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;testImplementation&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'android.arch.core:core-testing:1.1.1'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;junit-5&quot;&gt;JUnit 5&lt;/h2&gt;
&lt;p&gt;This doesn‚Äôt work for JUnit 5 however as the concept of &lt;code class=&quot;highlighter-rouge&quot;&gt;Rule&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;TestRunner&lt;/code&gt; are merged into one single concept of &lt;a href=&quot;https://junit.org/junit5/docs/current/user-guide/#extensions&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Extensions&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Hence we can create a similar extension like the &lt;code class=&quot;highlighter-rouge&quot;&gt;InstantTaskExecutorRule&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;androidx.arch.core.executor.ArchTaskExecutor&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;androidx.arch.core.executor.TaskExecutor&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.junit.jupiter.api.extension.AfterEachCallback&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.junit.jupiter.api.extension.BeforeEachCallback&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.junit.jupiter.api.extension.ExtensionContext&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;InstantExecutorExtension&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BeforeEachCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AfterEachCallback&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beforeEach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ExtensionContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ArchTaskExecutor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setDelegate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;TaskExecutor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;executeOnDiskIO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runnable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Runnable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;runnable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;postToMainThread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runnable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Runnable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;runnable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isMainThread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Boolean&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;afterEach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ExtensionContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ArchTaskExecutor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setDelegate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This basically does two things:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;set a delegate before each test that updates live data values immediately on the calling thread&lt;/li&gt;
  &lt;li&gt;remove the delegate after each tests to avoid influencing other tests.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Using this, the JUnit 4 test can easily be converted to JUnit 5:&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;@ExtendWith&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InstantExecutorExtension&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;PhotosViewModelTest&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;mutableLiveData&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MutableLiveData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;()&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;mutableLiveData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;postValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mutableLiveData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Voila! That‚Äôs it.&lt;/p&gt;

&lt;h2 id=&quot;wrap-up&quot;&gt;Wrap-up&lt;/h2&gt;
&lt;p&gt;In order to test LiveData, it‚Äôs values need to be directly updated on the calling thread. This can be done using
a rule in JUnit 4 or an extension in JUnit 5.&lt;/p&gt;

&lt;p&gt;If you‚Äôve made it this far you should probably follow me on &lt;span&gt;&lt;a href=&quot;https://twitter.com/molsjeroen?source=testinglivedatainjunit4andjunit52019&quot; class=&quot;ga-link&quot; target=&quot;_blank&quot;&gt;Twitter&lt;/a&gt;&lt;/span&gt;
. Feel free leave a comment below!&lt;/p&gt;</content><author><name>Jeroen Mols</name></author><category term="testing" /><category term="architecture" /><category term="livedata" /><summary type="html">Architecture components are one of the most exciting things that happened to Android in the past years. But how do you effectively go about and testing this?</summary></entry><entry><title type="html">Year in review 2018</title><link href="https://jeroenmols.com/blog/2019/01/01/yearinreview/" rel="alternate" type="text/html" title="Year in review 2018" /><published>2019-01-01T00:00:00+01:00</published><updated>2019-01-01T00:00:00+01:00</updated><id>https://jeroenmols.com/blog/2019/01/01/yearinreview</id><content type="html" xml:base="https://jeroenmols.com/blog/2019/01/01/yearinreview/">&lt;p&gt;Sitting in our own couch, in our own house, kids safely asleep upstairs,‚Ä¶ The road here was brutal, but the result is extraordinary.&lt;/p&gt;

&lt;p&gt;The past year was (hopefully) the busiest year of my entire life. In the midst of raising two amazing kids, a challenging full-time job and being an active GDE, we built our dream house!&lt;/p&gt;

&lt;p&gt;Looking back I honestly don‚Äôt know how we managed to pull all of this off‚Ä¶ Choosing everything for the house, selecting and planning all contractors and even doing some (a lot more than anticipated) work myself‚Ä¶ Anyways, I won‚Äôt bother you with the details, but if not for my wife and kids I would have broken down completely. The goal justifies the means.&lt;/p&gt;

&lt;p&gt;Also at work, it was a non-trivial and very demanding year. I used to pride myself for being great at keeping a work-life balance, but‚Ä¶ being a responsible for a team of people can really be quite intense.&lt;/p&gt;

&lt;p&gt;Our team had quite some challenges thrown at us, and we really made the best of it: sometimes massively successful, but we also struggled‚Ä¶ All in all, we did get a tight grip on our regression, laid the groundwork to improve our architecture and migrated to continuous deployment. (talk coming 2019 ;) )&lt;/p&gt;

&lt;p&gt;In 2018, I/we mostly invested in our family‚Äôs future and:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Built and moved into our dream house&lt;/li&gt;
  &lt;li&gt;Helped our daughter go to school and taught our son how to walk&lt;/li&gt;
  &lt;li&gt;Spoke at &lt;a href=&quot;https://jeroenmols.com/speaking/&quot;&gt;4 big conferences&lt;/a&gt; and 1 meetup.&lt;/li&gt;
  &lt;li&gt;Wrote &lt;a href=&quot;http://jeroenmols.com/blog/&quot;&gt;9 blog posts&lt;/a&gt;, not making my goal of 1 per month&lt;/li&gt;
  &lt;li&gt;Almost double my &lt;a href=&quot;https://twitter.com/molsjeroen&quot;&gt;Twitter&lt;/a&gt; followers to more than 3620&lt;/li&gt;
  &lt;li&gt;Got 6 times featured in &lt;a href=&quot;http://androidweekly.net/search?keyword=jeroen+mols&amp;amp;commit=Search&quot;&gt;Android weekly&lt;/a&gt; and several times in &lt;a href=&quot;http://mailchi.mp/kotlinweekly/kotlin-weekly-118&quot;&gt;Kotlin weekly&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Exclusively used Kotlin for every blog post and slide deck&lt;/li&gt;
  &lt;li&gt;Helped Pluralsight built a &lt;a href=&quot;https://app.pluralsight.com/score/skill-assessment/kotlin-app-fundamentals/intro?context=skills#/v2/landing&quot;&gt;Kotlin: App Fundamentals&lt;/a&gt; assessment&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://jeroenmols.com/img/blog/yearinreview18/christmas_tree.jpg&quot; alt=&quot;Garden view&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Looking forward to next year, I‚Äôm planning on living more! I‚Äôve bought quite a few Lego‚Äôs I‚Äôd like to build, want to bring my kids to school by bike, spend more quality time with my wife and just professionally waste time on occasion. :)&lt;/p&gt;

&lt;p&gt;I‚Äôm going to try and increase my community efforts back to 2017 level and maybe experiment with some new formats, such as &lt;a href=&quot;https://jeroenmols.com/blog/2018/12/06/fixthetest/&quot;&gt;my last blog post&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;As always you can reach me &lt;span&gt;&lt;a href=&quot;https://twitter.com/molsjeroen?source=yearinreview20182019&quot; class=&quot;ga-link&quot; target=&quot;_blank&quot;&gt;@molsjeroen&lt;/a&gt;&lt;/span&gt;
 on twitter, or leave a comment below!&lt;/p&gt;</content><author><name>Jeroen Mols</name></author><category term="review" /><summary type="html">Sitting in our own couch, in our own house, kids safely asleep upstairs,‚Ä¶ The road here was brutal, but the result is extraordinary.</summary></entry><entry><title type="html">Can you fix the test?</title><link href="https://jeroenmols.com/blog/2018/12/06/fixthetest/" rel="alternate" type="text/html" title="Can you fix the test?" /><published>2018-12-06T00:00:00+01:00</published><updated>2018-12-06T00:00:00+01:00</updated><id>https://jeroenmols.com/blog/2018/12/06/fixthetest</id><content type="html" xml:base="https://jeroenmols.com/blog/2018/12/06/fixthetest/">&lt;p&gt;Learning from analyzing code is one of the greatest ways to improve your skills. Can you spot the mistakes in the tests below?&lt;/p&gt;

&lt;p&gt;This post brings a fun little quiz for both testing gurus as novices, with a deep dive into the how and why of awesome tests.&lt;/p&gt;

&lt;h2 id=&quot;case-1-sugary&quot;&gt;Case 1: sugary&lt;/h2&gt;
&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Instrumented test, run on Android device.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;@RunWith&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AndroidJUnit4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CalculatorTest&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TestCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_sumShouldAddNumbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Calculator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;assertThat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isEqualTo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Take a good look at the test above and think what you would do differently.&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;Don‚Äôt worry, I‚Äôll wait.&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;Ready?&lt;/p&gt;

&lt;p&gt;Well there are actually quite some things wrong with this test, but the main problem is the syntax:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;CalculatorTest&lt;/code&gt; inherits from &lt;code class=&quot;highlighter-rouge&quot;&gt;TestCase&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;test_sumShouldAddNumbers()&lt;/code&gt; is prefixed with &lt;code class=&quot;highlighter-rouge&quot;&gt;test&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This is actually the old &lt;a href=&quot;http://junit.sourceforge.net/junit3.8.1/&quot;&gt;JUnit3&lt;/a&gt; syntax, whereas Android currently supports &lt;a href=&quot;https://junit.org/junit4/&quot;&gt;JUnit4&lt;/a&gt; (and even &lt;a href=&quot;https://junit.org/junit5/&quot;&gt;JUnit5&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;In these newer frameworks, the inheritance and prefixing are not required. All you have to do is annotate each test method with &lt;code class=&quot;highlighter-rouge&quot;&gt;@Test&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Instrumented test, run on Android device.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;@RunWith&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AndroidJUnit4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CalculatorTest&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumShouldAddNumbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Calculator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;assertThat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isEqualTo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Interestingly enough the JUnit4 conversion enables two additional optimizations:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;since &lt;code class=&quot;highlighter-rouge&quot;&gt;test&lt;/code&gt; prefix is not required for test methods, we can use the backtick notation in Kotlin to make more descriptive test names (e.g. `sum of 1 and 2 should equal 3`)&lt;/li&gt;
  &lt;li&gt;since we are only using JUnit4 now, there is no need to declare &lt;code class=&quot;highlighter-rouge&quot;&gt;@RunWith(AndroidJUnit4::class)&lt;/code&gt; as this is only required to run both JUnit3 and 4 tests in the same file&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This dramatically clarifies our test:&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CalculatorTest&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;should&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;equal&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Calculator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;assertThat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isEqualTo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that the test above also doesn‚Äôt need to be run on an Android device as it doesn‚Äôt use the Instrumentation framework.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;@RunWith()&lt;/code&gt; annotation was only added to be able to explain what &lt;code class=&quot;highlighter-rouge&quot;&gt;AndroidJunit4&lt;/code&gt; does.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;TL;DR All you need is @Test annotations on test methods&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;case-2-exceptional&quot;&gt;Case 2: exceptional&lt;/h2&gt;
&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;divide&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zero&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;should&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;an&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Calculator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;divide&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;fail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;No exception thrown&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Alright, now that you‚Äôre warmed up, have a good look at the next test.&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;Going for a quick coffee brb‚Ä¶&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;Trying to catch the exception yourself and making the test fail subsequently is quite verbose, no?&lt;/p&gt;

&lt;p&gt;There is actually a better way of doing this, by using the &lt;code class=&quot;highlighter-rouge&quot;&gt;expected&lt;/code&gt; annotation.&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expected&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RuntimeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;divide&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zero&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;should&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;an&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Calculator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;divide&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This doesn‚Äôt just amount to less code to write (and maintain) but you‚Äôll also get a proper error message out of the box.&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;java.lang.AssertionError: Expected exception: java.lang.RuntimeException
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;TL;DR Use @Test (expected = ‚Ä¶) for expected exceptions&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;case-3-assertive&quot;&gt;Case 3: assertive&lt;/h2&gt;
&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;should&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ask&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WebService&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mockWebService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mockWebService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mockWebService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;never&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;An example with mocks this time! Can you spot the improvement?&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;I‚Äôm not mocking you, I promise! ;)&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;Imagine for a second that the test above fails‚Ä¶ What could be the cause of that?&lt;/p&gt;

&lt;p&gt;There are actually a few different possibilities:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;either &lt;code class=&quot;highlighter-rouge&quot;&gt;login()&lt;/code&gt; was not called&lt;/li&gt;
  &lt;li&gt;or &lt;code class=&quot;highlighter-rouge&quot;&gt;logout()&lt;/code&gt; was called&lt;/li&gt;
  &lt;li&gt;or both of the above&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Because the test can fail for multiple reasons, you can never conclude from the failure output what the problem is. Instead you have to dive deeper into each failing test, which can be quite time consuming and frustrating.&lt;/p&gt;

&lt;p&gt;Wouldn‚Äôt it be nice if every tests would just fail for one single reason?&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;should&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ask&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WebService&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mockWebService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mockWebService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shouldn&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ask&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WebService&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logout&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mockWebService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mockWebService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;never&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If one of those fail, the test message will immediate tell you what‚Äôs going wrong!&lt;/p&gt;

&lt;p&gt;This actually isn‚Äôt the only reason why you should only use one single assert/verify per test:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;JUnit4 stops test execution after the first failure: so if the first assert fails, the following ones aren‚Äôt executed! Consequently you don‚Äôt know how many problems there are on test failure.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Too many assertions can make code nearly impossible to refactor: To fully test a login functionality, you probably need over 10 tests (username null, wrong password,‚Ä¶), right? Imagine that every single test also explicitly checks that logout isn‚Äôt called on login‚Ä¶ What happens now if your requirement changes and you need to support immediate logout after login? (e.g. For Android Wear) Then you would have to refactor all those tests!!!&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;TL;DR Use only one assert/verify per test&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;case-4-divided&quot;&gt;Case 4: divided&lt;/h2&gt;
&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;should&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;multiple&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;calculations&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;calculator&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Calculator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;calculator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;division&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;calculator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;divide&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;assertThat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;division&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isEqualTo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;You know the drill‚Ä¶&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;Let‚Äôs step through the test: first it calculates the sum of 1 and 2, followed by a division of the result by 3.&lt;/p&gt;

&lt;p&gt;Why are we testing that sequence? Mathematical operations (add/divide) aren‚Äôt supposed to have side effects (and influence each other), right?&lt;/p&gt;

&lt;p&gt;Even more, the interface of &lt;code class=&quot;highlighter-rouge&quot;&gt;Calculator&lt;/code&gt; makes that clear: both &lt;code class=&quot;highlighter-rouge&quot;&gt;sum()&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;divide()&lt;/code&gt; take all parameters they need as an input to produce an output.&lt;/p&gt;

&lt;p&gt;So if &lt;code class=&quot;highlighter-rouge&quot;&gt;sum()&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;divide()&lt;/code&gt; are already tested, there really isn‚Äôt an added benefit of testing the sequence, right?&lt;/p&gt;

&lt;p&gt;Instead, there are quite some disadvantages:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;the combined test is harder to understand (more steps)&lt;/li&gt;
  &lt;li&gt;the combined test can fail due to multiple reasons (causing more failure analysis effort).&lt;/li&gt;
  &lt;li&gt;it‚Äôs unclear what combinations of steps should be tested and which ones not (where do you stop?)&lt;/li&gt;
  &lt;li&gt;not really a unit test&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Hence this test should be split it two:&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;should&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;be&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Calculator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;assertThat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isEqualTo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;division&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;should&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;be&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1f&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;division&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Calculator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;divide&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;assertThat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;division&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isEqualTo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;TL;DR Only unit test one method per test&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;case-5-readable&quot;&gt;Case 5: readable&lt;/h2&gt;
&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;WebServiceTest&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;lateinit&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;webService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WebService&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;@Before&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;setUp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;webService&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WebServiceTestHelper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;createWebService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;should&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fail&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wrong&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;webService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;checkLoginFailed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let‚Äôs make things slightly more interesting‚Ä¶&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;Any ideas?&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;In order to understand what‚Äôs bad about this test, you need to imagine a lot more tests in the same file.&lt;/p&gt;

&lt;p&gt;If you where to encounter the test above somewhere in a file with a lot more tests, it would take you quite some time to figure out what‚Äôs going on:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Need to look at &lt;code class=&quot;highlighter-rouge&quot;&gt;setUp()&lt;/code&gt; method to understand where the WebService under test is coming from&lt;/li&gt;
  &lt;li&gt;Need to open &lt;code class=&quot;highlighter-rouge&quot;&gt;WebServiceTestHelper&lt;/code&gt;to understand the WebService initialization&lt;/li&gt;
  &lt;li&gt;Need to open &lt;code class=&quot;highlighter-rouge&quot;&gt;checkLoginFailed()&lt;/code&gt; method to see how a failed login is identified&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;That‚Äôs a lot of work!&lt;/p&gt;

&lt;p&gt;The problem here is that the reader constantly has to exit the test method to figure out what‚Äôs going on.&lt;/p&gt;

&lt;p&gt;Removing the &lt;code class=&quot;highlighter-rouge&quot;&gt;setUp&lt;/code&gt; method, inlining the &lt;code class=&quot;highlighter-rouge&quot;&gt;WebServiceTestHelper&lt;/code&gt; and the &lt;code class=&quot;highlighter-rouge&quot;&gt;checkLoginFailed()&lt;/code&gt; method yields the following.&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;WebServiceTest&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;`loginHasFailed`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;webService&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WebService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;webService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setUserCredentials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;email@google.com&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;‚Äú&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrong_pwd&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;‚Äù&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;webService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;assertThat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isSuccess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isFalse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Notice how easy it has now become to understand what‚Äôs going on in the test!&lt;/p&gt;

&lt;p&gt;But wouldn‚Äôt that lead to quite some code duplication you say? Well, I‚Äôm glad you ask. YES! But even though testing code is also production code, the &lt;a href=&quot;https://mtlynch.io/good-developers-bad-tests/&quot;&gt;same rules don‚Äôt&lt;/a&gt; completely apply.&lt;/p&gt;

&lt;p&gt;It is fine for test code to have duplication, magic numbers/strings, long method names,‚Ä¶  Readability and ease of fixing failures are what matter most.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;TL;DR Always keep the reader within the test function&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;case-6-trustworthy&quot;&gt;Case 6: trustworthy&lt;/h2&gt;
&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;should&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;properly&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;expectedTime&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FORMAT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;formattedTime&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TimeFormatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;currentFormattedTime&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expectedTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;formattedTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;companion&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;FORMAT&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SimpleDateFormat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HH:mm:ss:SSS&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And the final contender of the day is‚Ä¶&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;Any ideas?&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;Simply put, this test is flaky. It will only fail very rarely, but still it will.&lt;/p&gt;

&lt;p&gt;Reason for this is that the &lt;code class=&quot;highlighter-rouge&quot;&gt;expectedTime&lt;/code&gt; isn‚Äôt the time used by the &lt;code class=&quot;highlighter-rouge&quot;&gt;TimeFormatter&lt;/code&gt; and hence there will be a slight difference (~ ns) between both. When rounding works against us, this could actually end up in a real formatted ms difference.&lt;/p&gt;

&lt;p&gt;And flakiness in tests, well‚Ä¶ no matter how infrequent, we should have a &lt;a href=&quot;/blog/2017/02/16/unittests/&quot;&gt;zero tolerance policy&lt;/a&gt; towards them. This is because flakiness can completely destroy the confidence of the team in the test suite.&lt;/p&gt;

&lt;p&gt;Fortunately this can easily be fixed by passing the current time into the &lt;code class=&quot;highlighter-rouge&quot;&gt;TimeFormatter&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;should&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;properly&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;expectedTime&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FORMAT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;formattedTime&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TimeFormatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;currentFormattedTime&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expectedTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;formattedTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;companion&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;FORMAT&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SimpleDateFormat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HH:mm:ss:SSS&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;TL;DR Tests should never randomly fail&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;wrap-up&quot;&gt;Wrap-up&lt;/h2&gt;
&lt;p&gt;Putting it all together, great tests follow the following principles:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;All you need is @Test annotations on test methods&lt;/li&gt;
  &lt;li&gt;Use @Test (expected = ‚Ä¶) for expected exceptions&lt;/li&gt;
  &lt;li&gt;Only one assert/verify per test&lt;/li&gt;
  &lt;li&gt;Only unit test one method per test&lt;/li&gt;
  &lt;li&gt;Always keep the reader within the test function&lt;/li&gt;
  &lt;li&gt;Tests should never randomly fail&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Check out my slides/video to learn more about &lt;a href=&quot;https://speakerdeck.com/jeroenmols/write-awesome-unit-tests&quot;&gt;awesome unit tests&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If you‚Äôve made it this far you should probably follow me on &lt;span&gt;&lt;a href=&quot;https://twitter.com/molsjeroen?source=canyoufixthetest?2018&quot; class=&quot;ga-link&quot; target=&quot;_blank&quot;&gt;Twitter&lt;/a&gt;&lt;/span&gt;
. Feel free leave a comment below!&lt;/p&gt;</content><author><name>Jeroen Mols</name></author><category term="testing" /><category term="kotlin" /><category term="cleancode" /><summary type="html">Learning from analyzing code is one of the greatest ways to improve your skills. Can you spot the mistakes in the tests below?</summary></entry><entry><title type="html">Kotlin Stackoverflow error</title><link href="https://jeroenmols.com/blog/2018/11/01/kotlinstackoverflow/" rel="alternate" type="text/html" title="Kotlin Stackoverflow error" /><published>2018-11-01T00:00:00+01:00</published><updated>2018-11-01T00:00:00+01:00</updated><id>https://jeroenmols.com/blog/2018/11/01/kotlinstackoverflow</id><content type="html" xml:base="https://jeroenmols.com/blog/2018/11/01/kotlinstackoverflow/">&lt;p&gt;Java interop is one of the best features of the Kotlin language, yet sometimes this also can cause unforeseen issues‚Ä¶&lt;/p&gt;

&lt;h2 id=&quot;puzzle&quot;&gt;Puzzle&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;Disclaimer, the example below is a consequence of legacy code and only serves to demonstrate a Kotlin puzzler.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Have a look at the simple test class below. It subclasses the subject under test (&lt;code class=&quot;highlighter-rouge&quot;&gt;BaseFragment&lt;/code&gt;) to inject a mocked &lt;code class=&quot;highlighter-rouge&quot;&gt;Repository&lt;/code&gt; that is used by the &lt;code class=&quot;highlighter-rouge&quot;&gt;getDataOperation()&lt;/code&gt; method in the test.&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;BaseFragmentTest&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;@get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Rule&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;mockitoRule&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MockitoJUnit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;@Mock&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;lateinit&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;repository&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Repository&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;should&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;be&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expected&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;actual&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TestFragment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getDataOperation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;actual&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;expected&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;inner&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TestFragment&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BaseFragment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getRepository&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Repository&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;repository&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What do you think will happen we run the test?&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;Well‚Ä¶&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;java.lang.StackOverflowError
    at com.jeroenmols.BaseFragmentTest$TestFragment.getRepository(BaseFragmentTest.kt:26)
    at com.jeroenmols.BaseFragmentTest$TestFragment.getRepository(BaseFragmentTest.kt:26)
    at com.jeroenmols.BaseFragmentTest$TestFragment.getRepository(BaseFragmentTest.kt:26)
    at com.jeroenmols.BaseFragmentTest$TestFragment.getRepository(BaseFragmentTest.kt:26)
    at com.jeroenmols.BaseFragmentTest$TestFragment.getRepository(BaseFragmentTest.kt:26)
    at com.jeroenmols.BaseFragmentTest$TestFragment.getRepository(BaseFragmentTest.kt:26)
    at com.jeroenmols.BaseFragmentTest$TestFragment.getRepository(BaseFragmentTest.kt:26)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Wait, what???&lt;/p&gt;

&lt;p&gt;This trace indicates that the line &lt;code class=&quot;highlighter-rouge&quot;&gt;return repository&lt;/code&gt; (line 26) is called recursively‚Ä¶ How is that even possible? That line just return a value, right?&lt;/p&gt;

&lt;p&gt;Well‚Ä¶&lt;/p&gt;

&lt;h1 id=&quot;explanation&quot;&gt;Explanation&lt;/h1&gt;
&lt;p&gt;This is actually a very interesting case of Java/Kotlin interop. Because a Kotlin property is compiled down to the following Java elements:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;a getter method with &lt;code class=&quot;highlighter-rouge&quot;&gt;get&lt;/code&gt; prefix&lt;/li&gt;
  &lt;li&gt;a setter method with &lt;code class=&quot;highlighter-rouge&quot;&gt;set&lt;/code&gt; prefix&lt;/li&gt;
  &lt;li&gt;a private field backing the property&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Hence the &lt;code class=&quot;highlighter-rouge&quot;&gt;return repository&lt;/code&gt; statement actually ends up executing &lt;code class=&quot;highlighter-rouge&quot;&gt;return getRepository()&lt;/code&gt; and hence recursively calling itself!&lt;/p&gt;

&lt;p&gt;Now the really interesting detail here is that this only happens when &lt;code class=&quot;highlighter-rouge&quot;&gt;BaseFragment&lt;/code&gt; is a Java class! When converting the class to Kotlin this doesn‚Äôt happen.&lt;/p&gt;

&lt;p&gt;So let‚Äôs have a look at the decompiled bytecode:&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Decompiled when BaseFragment in Java&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TestFragment&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BaseFragment&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;@NotNull&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Repository&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getRepository&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getRepository&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Decompiled when BaseFragment in Kotlin&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TestFragment&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BaseFragment&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;@NotNull&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Repository&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getRepository&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BaseFragmentTest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getRepository&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sure enough, the decompiled Java code recursively links to the &lt;code class=&quot;highlighter-rouge&quot;&gt;TestFragment&lt;/code&gt; when &lt;code class=&quot;highlighter-rouge&quot;&gt;BaseFragment&lt;/code&gt; is in java and properly links to the right method when &lt;code class=&quot;highlighter-rouge&quot;&gt;BaseFragment&lt;/code&gt; is in Kotlin.&lt;/p&gt;

&lt;p&gt;A simple way to fix this is to strongly refer the overridden method to point at the &lt;code class=&quot;highlighter-rouge&quot;&gt;BaseFragmentTest&lt;/code&gt; class:&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;inner&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TestFragment&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BaseFragment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getRepository&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Repository&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;@BaseFragmentTest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;repository&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Fortunately Android Studio also warns you about recursion with an indicator:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://jeroenmols.com/img/blog/kotlinstackoverflow/androidstudio_warning.png&quot; alt=&quot;Android Studio recursive function indicator&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;wrap-up&quot;&gt;Wrap-up&lt;/h2&gt;
&lt;p&gt;This post indicates an interesting case where methods/properties get linked incorrectly when inheriting from a Java class in Kotlin. Fortunately, Android Studio and the decompiled bytecode clearly indicate what is going wrong.&lt;/p&gt;

&lt;p&gt;If you‚Äôve made it this far you should probably follow me on &lt;span&gt;&lt;a href=&quot;https://twitter.com/molsjeroen?source=kotlinstackoverflowerror2018&quot; class=&quot;ga-link&quot; target=&quot;_blank&quot;&gt;Twitter&lt;/a&gt;&lt;/span&gt;
. Feel free leave a comment below!&lt;/p&gt;</content><author><name>Jeroen Mols</name></author><category term="kotlin" /><category term="stackoverflow" /><category term="puzzle" /><summary type="html">Java interop is one of the best features of the Kotlin language, yet sometimes this also can cause unforeseen issues‚Ä¶</summary></entry><entry><title type="html">Kotlinconf 2018 slides</title><link href="https://jeroenmols.com/blog/2018/10/05/kotlinconf18/" rel="alternate" type="text/html" title="Kotlinconf 2018 slides" /><published>2018-10-05T00:00:00+02:00</published><updated>2018-10-05T00:00:00+02:00</updated><id>https://jeroenmols.com/blog/2018/10/05/kotlinconf18</id><content type="html" xml:base="https://jeroenmols.com/blog/2018/10/05/kotlinconf18/">&lt;p&gt;Was really great visiting Kotlinconf this year and I wanted to do a quick post to link to all of it‚Äôs wonderful content.&lt;/p&gt;

&lt;h2 id=&quot;conference-slides&quot;&gt;Conference slides&lt;/h2&gt;
&lt;p&gt;While you will be able to find all recordings &lt;a href=&quot;https://www.youtube.com/playlist?list=PLQ176FUIyIUbVvFMqDc2jhxS-t562uytr&quot;&gt;here&lt;/a&gt;, I often find it useful to be able to quickly scan through the slides. Hence I bundled everything I could already find from socials.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://chris.banes.me/talks/2018/android-suspenders/&quot;&gt;Android suspenders&lt;/a&gt; by Chris Banes&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://adavis.info/2018/06/talk-getting-a-grip-on-graphql.html&quot;&gt;GraphQL powered by Kotlin&lt;/a&gt; by Annyce Davis&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://twitter.com/eskat0s/status/1047871129916985344&quot;&gt;Type safe build logic with the Gradle Kotlin DSL&lt;/a&gt; by Hans Dockter &amp;amp; Paul Merlin&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/hzsweers/annotation-processing-in-a-kotlin-world&quot;&gt;Annotation processing in a Kotlin world&lt;/a&gt; by Zac Sweers&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/dwursteisen/beat-the-high-score-build-a-game-using-libgdx-and-kotlin&quot;&gt;Beat the high-score: build a game using libGDX and Kotlin&lt;/a&gt; by David Wursteisen&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/npryce/the-kotlin-type-hierarchy-from-top-to-bottom&quot;&gt;The Kotlin Type Hierarchy From Top to Bottom&lt;/a&gt; by Nat Pryce&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://rakhman.info/slides/Writing_Browser_Extensions_in_Kotlin.pdf&quot;&gt;Writing Browser Extensions in Kotlin&lt;/a&gt; by Kirill Rakhman&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.slideshare.net/nfrankel/kotlinconf-kotlin-and-spring-boot-a-match-made-in-heaven&quot;&gt;Kotlin and Spring Boot, a match made in heaven&lt;/a&gt; by Nicolas Frankel&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.icloud.com/keynote/0tDiYquR2JrHV_85mDgZtJv6g#Presentation_KotlinConf_-_wide&quot;&gt;Effective multiplatform Kotlin development&lt;/a&gt; by Marcin Moskala&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/thomasnield/kotlinconf-2018-mathematical-modeling/blob/master/kotlinconf_slides_2018.pdf&quot;&gt;Mathematical Modeling with Kotlin&lt;/a&gt; by Thomas Nield&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/dkandalov/kotlin-native-snake&quot;&gt;Live Coding Kotlin/Native Snake&lt;/a&gt; by Dmitry Kandalov&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/jakewharton/a-multiplatform-delight-kotlinconf-2018&quot;&gt;A Multiplatform Delight&lt;/a&gt; by Jake Wharton and Alec Strong&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/romainguy/graphics-programming-with-kotlin&quot;&gt;Graphics Programming with Kotlin&lt;/a&gt; by Romain Guy&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://agiledeveloper.com/presentations/creating_internal_dsls_in_kotlin.zip&quot;&gt;Creating Internal DSLs in Kotlin&lt;/a&gt; by Venkat Subramaniam&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://agiledeveloper.com/presentations/exploring_coroutines_in_kotlin.zip&quot;&gt;Exploring Coroutines in Kotlin&lt;/a&gt; by Venkat Subramaniam&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/angryziber/kotlin-puzzlers/tree/master/kotlinconf2018&quot;&gt;Kotlin puzzlers&lt;/a&gt; by Anton Keks&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/dankim/android-ktx-a-dash-of-kotlin-makes-all-the-difference-kotlinconf-2018&quot;&gt;Android KTX: A dash of Kotlin makes all the difference!&lt;/a&gt; by Dan Kim&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/k4kya/kotlinconf-18-learn-together-not-the-same&quot;&gt;Learn together. Not the same.&lt;/a&gt; by Amal Kakaiya and Maria Neumayer&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/mutexkid/native&quot;&gt;Speaker Deck Making Noise With Kotlin/Native&lt;/a&gt; by Josh Skeen&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/rharter/servers-kotlin&quot;&gt;Servers ‚ù§Ô∏è Kotlin&lt;/a&gt; by Ryan Harter&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/s4nchez/server-as-a-function-in-kotlin-kotlinconf-2018&quot;&gt;Server as a Function in Kotlin&lt;/a&gt; by Ivan Sanchez&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://holgerbrandl.github.io/data_science_with_kotlin/data_science_with_kotlin.html&quot;&gt;Building Data Science Workflows with Kotlin&lt;/a&gt; by Holger Brandl&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/queencodemonkey/dissecting-the-stdlib&quot;&gt;Dissecting the stdlib&lt;/a&gt; by Huyen Tue Dao&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://gateway.ipfs.io/ipfs/QmRsk7YWYB9YkQwDcFFaZmhWHPgBXnAMHc1maZchwp6oBP&quot;&gt;Kotlin - a great fit for the Ethereum ecosystem&lt;/a&gt; by Marcus Ligi&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.google.com/presentation/d/1-a5v5PbnsCcVHqlA7kvzffYhOttuJ51bkHk4_6-aPj0&quot;&gt;Painless Microservices in Kotlin&lt;/a&gt; by Fedor Korotkov&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/nightlynexus/performant-multiplatform-kotlin-serialization/&quot;&gt;Performant Multiplatform Kotlin Serialization&lt;/a&gt; by Eric Cochran&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/kpgalligan/ios-architecture-with-multiplatform&quot;&gt;iOS Architecture with Multiplatform&lt;/a&gt; by Kevin Galligan&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/xenji/stream-processors-in-kotlin-kotlinconf-2018-edition&quot;&gt;Writing Stream Processors in Kotlin&lt;/a&gt; by Mario Mueller&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/alecstrong/whats-the-big-idea-writing-intellij-plugins-for-kotlin&quot;&gt;What‚Äôs the big IDEA? Writing IntelliJ plugins for Kotlin&lt;/a&gt; by Alec Strong and Egor Andreevici&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/asarazan/next-level-dsls&quot;&gt;Next Level DSLs&lt;/a&gt; by Aaron Sarazan&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/kevinmost/writing-your-first-kotlin-compiler-plugin&quot;&gt;Writing Your First Kotlin Compiler Plugin&lt;/a&gt; by Kevin Most&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/alostpacket/sealed-classes-opened-my-mind&quot;&gt;Sealed classes opened my mind&lt;/a&gt; by Patrick Cousins&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/amanda_hinchman/kotlin-the-next-frontier-for-modern-meta-programming&quot;&gt;Kotlin: The Next Frontier for Modern (Meta)Programming&lt;/a&gt; by Amanda Hinchman-Dominguez&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://speakerdeck.com/raulraja/architecting-typed-fp-applications-and-libraries-in-kotlin-with-lrrow&quot;&gt;Functional Programming in Kotlin with Œõrrow&lt;/a&gt; by Ra√∫l Raja Mart√≠nez&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;credits&quot;&gt;Credits&lt;/h2&gt;
&lt;p&gt;Many thanks to the JetBrains team for organizing such a delightful conference! To all sponsors for making this event possible. And to the entire Android community for being so awesome!&lt;/p&gt;

&lt;p&gt;Hope to see you all next year!&lt;/p&gt;

&lt;p&gt;Helpful? Got extra slides? Hit me up on &lt;span&gt;&lt;a href=&quot;https://twitter.com/molsjeroen?source=kotlinconf2018slides2018&quot; class=&quot;ga-link&quot; target=&quot;_blank&quot;&gt;Twitter&lt;/a&gt;&lt;/span&gt;
.&lt;/p&gt;</content><author><name>Jeroen Mols</name></author><category term="android" /><category term="conference" /><category term="kotlinconf" /><summary type="html">Was really great visiting Kotlinconf this year and I wanted to do a quick post to link to all of it‚Äôs wonderful content.</summary></entry><entry><title type="html">A little Kotlin puzzler</title><link href="https://jeroenmols.com/blog/2018/09/25/kotlinpuzzler/" rel="alternate" type="text/html" title="A little Kotlin puzzler" /><published>2018-09-25T00:00:00+02:00</published><updated>2018-09-25T00:00:00+02:00</updated><id>https://jeroenmols.com/blog/2018/09/25/kotlinpuzzler</id><content type="html" xml:base="https://jeroenmols.com/blog/2018/09/25/kotlinpuzzler/">&lt;p&gt;Kotlin is an incredibly enjoyable, concise and powerful programming language. Yet sometimes also a bit confusing‚Ä¶&lt;/p&gt;

&lt;h2 id=&quot;puzzle&quot;&gt;Puzzle&lt;/h2&gt;
&lt;p&gt;Have a look at the simple class below. It simulates an ongoing operation by smoothly moving a progress bar from 0 to 100 over the course of 30 seconds:&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ProgressbarAnimator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;progressBar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ProgressBar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AnimatorUpdateListener&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;lateinit&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ValueAnimator&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;configureAnimator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addUpdateListener&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;configureAnimator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;endValue&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FPS&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DURATION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;progressBar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endValue&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ValueAnimator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ofInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;duration&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DURATION&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interpolator&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LinearInterpolator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;onAnimationUpdate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ValueAnimator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;progressBar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;progress&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;animatedValue&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Int&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;companion&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;FPS&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.06&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;DURATION&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;30&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000L&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What do you think will happen if we instantiate one of these with a given progress bar?&lt;/p&gt;

&lt;p&gt;Well‚Ä¶ nothing! The progress bar doesn‚Äôt move at all.&lt;/p&gt;

&lt;p&gt;Can you spot what‚Äôs wrong? The error is in the following lines:&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;configureAnimator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addUpdateListener&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Any luck?&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;Well this is the actual culprit:&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addUpdateListener&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There is syntactically a very subtle, yet incredibly important difference between that line and this:&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addUpdateListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If we change our init to the latter, then the progress bar works as expected!&lt;/p&gt;

&lt;h1 id=&quot;explanation&quot;&gt;Explanation&lt;/h1&gt;
&lt;p&gt;One of the Kotlin features is that if the last argument of a method call is a lambda, you can move the lambda outside of the method invocation. (which is great for building &lt;a href=&quot;https://proandroiddev.com/writing-dsls-in-kotlin-part-1-7f5d2193f277&quot;&gt;DSLs&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Consequently,&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addUpdateListener&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;is equivalent to&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addUpdateListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and even&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addUpdateListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and by expanding the lambda, this&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addUpdateListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So the reason why the progress bar wasn‚Äôt working is simple. Instead of registering itself as an &lt;code class=&quot;highlighter-rouge&quot;&gt;AnimationUpdateListener&lt;/code&gt;, it actually registered a lambda, a new function to handle the animation updates.&lt;/p&gt;

&lt;p&gt;So every animation update the lambda &lt;code class=&quot;highlighter-rouge&quot;&gt;{ _ -&amp;gt; this }&lt;/code&gt; was invoked instead of the &lt;code class=&quot;highlighter-rouge&quot;&gt;onAnimationUpdate&lt;/code&gt; method. Thereby not doing anything, it just has the &lt;code class=&quot;highlighter-rouge&quot;&gt;this&lt;/code&gt; object without any invocation on it.&lt;/p&gt;

&lt;p&gt;Equivalent to writing the following function:&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doNothing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Perfectly valid syntax, but otherwise completely useless.&lt;/p&gt;

&lt;h2 id=&quot;wrap-up&quot;&gt;Wrap-up&lt;/h2&gt;
&lt;p&gt;A very subtle difference in syntax (&lt;code class=&quot;highlighter-rouge&quot;&gt;{}&lt;/code&gt; instead of &lt;code class=&quot;highlighter-rouge&quot;&gt;()&lt;/code&gt;) can make a huge difference in what the code actually does. Kotlin is a very powerful programming language, but with great power comes great‚Ä¶&lt;/p&gt;

&lt;p&gt;If you‚Äôve made it this far you should probably follow me on &lt;span&gt;&lt;a href=&quot;https://twitter.com/molsjeroen?source=alittlekotlinpuzzler2018&quot; class=&quot;ga-link&quot; target=&quot;_blank&quot;&gt;Twitter&lt;/a&gt;&lt;/span&gt;
. Feel free leave a comment below!&lt;/p&gt;</content><author><name>Jeroen Mols</name></author><category term="kotlin" /><category term="lambda" /><category term="puzzle" /><summary type="html">Kotlin is an incredibly enjoyable, concise and powerful programming language. Yet sometimes also a bit confusing‚Ä¶</summary></entry><entry><title type="html">How dangerous permissions sneak into apps</title><link href="https://jeroenmols.com/blog/2018/08/02/phonestatepermission/" rel="alternate" type="text/html" title="How dangerous permissions sneak into apps" /><published>2018-08-02T00:00:00+02:00</published><updated>2018-08-02T00:00:00+02:00</updated><id>https://jeroenmols.com/blog/2018/08/02/phonestatepermission</id><content type="html" xml:base="https://jeroenmols.com/blog/2018/08/02/phonestatepermission/">&lt;p&gt;This is a post-mortem where the very dangerous permission, &lt;code class=&quot;highlighter-rouge&quot;&gt;READ_PHONE_STATE&lt;/code&gt;, unintentionally sneaked into our app. Here‚Äôs how this could happen, how we debugged and finally how we solved it.&lt;/p&gt;

&lt;h2 id=&quot;prologue&quot;&gt;Prologue&lt;/h2&gt;
&lt;p&gt;Sprint comes to an end and we‚Äôre happy to deliver a new release of our app. After rolling it out to our beta community without issues, we move ahead to production.&lt;/p&gt;

&lt;p&gt;While everything looks fine at first, after a while we see users complaining:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://jeroenmols.com/img/blog/phonestatepermission/userreview.png&quot; alt=&quot;Users complaining: Why does this app want to know if I'm in a phone call and who I'm calling?&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Honestly we were completely taken aback by this‚Ä¶ But sure enough looking at the play store:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://jeroenmols.com/img/blog/phonestatepermission/permissionsoverview.png&quot; alt=&quot;Google play store permissions&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;root-cause&quot;&gt;Root cause&lt;/h2&gt;
&lt;p&gt;If you ever run into a similar issue, the Android Studio merged manifest view is the way to go. Just open your manifest and click the &lt;code class=&quot;highlighter-rouge&quot;&gt;Merged manifest&lt;/code&gt; tab at the bottom.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://jeroenmols.com/img/blog/phonestatepermission/mergedmanifest.png&quot; alt=&quot;Google play store permissions&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Sure enough, the &lt;code class=&quot;highlighter-rouge&quot;&gt;READ_PHONE_STATE&lt;/code&gt; permission is there.&lt;/p&gt;

&lt;p&gt;Unfortunately, this view couldn‚Äôt help us find where the permission was merged from:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Double-clicking the permission led us back to normal manifest view&lt;/li&gt;
  &lt;li&gt;Color coding palette is so subtle that we couldn‚Äôt see what color the permission was highlighted in&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;center&gt;&lt;img style=&quot;width: 85%&quot; src=&quot;https://jeroenmols.com/img/blog/phonestatepermission/mergedmanifestcolors.png&quot; alt=&quot;Color highlighting of manifest merger needs an extremely trained eye to map it on the legend&quot; /&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;Fortunately, the manifest merger also prints a log file to &lt;code class=&quot;highlighter-rouge&quot;&gt;build/outputs/logs&lt;/code&gt; that describes where everything is merged from.&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;img style=&quot;width: 85%&quot; src=&quot;https://jeroenmols.com/img/blog/phonestatepermission/manifestmerger.png&quot; alt=&quot;Output logs of the manifest merger are located at build/outputs/logs&quot; /&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;This file gave a clear answer:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;uses-permission#android.permission.READ_PHONE_STATE
IMPLIED from /app/src/debug/AndroidManifest.xml:8:1-15:12
reason: hue.libraries.translations has a targetSdkVersion &amp;lt; 4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Wow‚Ä¶ That‚Äôs nasty!&lt;/p&gt;

&lt;p&gt;A while ago we decided to move all our translations to a new module, with an empty manifest and a bare-bones &lt;code class=&quot;highlighter-rouge&quot;&gt;build.gradle&lt;/code&gt; file:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;apply&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;plugin:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'com.android.library'&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;android&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;compileSdkVersion&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;compileSdk&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And because we didn‚Äôt explicitly set the targetSdk, a targetSdk of 1 is assumed and hence we end up with a &lt;a href=&quot;https://developer.android.com/reference/android/Manifest.permission.html#READ_PHONE_STATE&quot;&gt;dangerous permission&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;To be fair, the documentation does warn you about this:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://jeroenmols.com/img/blog/phonestatepermission/permissiondisclaimer.png&quot; alt=&quot;Google play store permissions&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;But still‚Ä¶ wow!&lt;/p&gt;

&lt;h2 id=&quot;solution&quot;&gt;Solution&lt;/h2&gt;
&lt;p&gt;While a solution could be to simply set the targetSdk in our translations module. This wouldn‚Äôt prevent something similar from happening in the future.&lt;/p&gt;

&lt;p&gt;Therefore we decided to set the targetSdk (and others) for all our modules in the top level &lt;code class=&quot;highlighter-rouge&quot;&gt;build.gradle&lt;/code&gt; file. This also keeps submodule &lt;code class=&quot;highlighter-rouge&quot;&gt;build.gradle&lt;/code&gt; files lean.&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;subprojects&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;afterEvaluate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;project&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;project&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;plugins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findPlugin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'android'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;project&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;plugins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;findPlugin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'android-library'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;android&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;buildToolsVersion&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;buildTools&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;compileSdkVersion&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;compileSdk&lt;/span&gt;

                &lt;span class=&quot;n&quot;&gt;defaultConfig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;minSdkVersion&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;minSdk&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;targetSdkVersion&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;compileSdk&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

                &lt;span class=&quot;n&quot;&gt;compileOptions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;sourceCompatibility&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;javaVersion&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;targetCompatibility&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;javaVersion&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Additionally, we also wanted to protect ourselves against 3rd party library developers that could make this mistake. To do so, you can inform the manifest merger to remove the permission while merging by adding the following to your manifest:&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;uses-permission&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;android.permission.READ_PHONE_STATE&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;tools:node=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;remove&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That is overkill you say?&lt;/p&gt;

&lt;p&gt;Well, &lt;a href=&quot;https://github.com/firebase/quickstart-unity/issues/68&quot;&gt;Firebase&lt;/a&gt; AND &lt;a href=&quot;https://developers.google.com/android/guides/releases#november_2016_version_100&quot;&gt;Google play services&lt;/a&gt; already made this booboo in the past.&lt;/p&gt;

&lt;p&gt;‚Ä¶ wow!&lt;/p&gt;

&lt;h2 id=&quot;wrap-up&quot;&gt;Wrap-up&lt;/h2&gt;
&lt;p&gt;Not explicitly setting your target SDK version will cause a dangerous permission to sneak into your app. Make sure you set the target SDK in every module and protect yourself from 3rd party libraries.&lt;/p&gt;

&lt;p&gt;If you‚Äôve made it this far you should probably follow me on &lt;span&gt;&lt;a href=&quot;https://twitter.com/molsjeroen?source=howdangerouspermissionssneakintoapps2018&quot; class=&quot;ga-link&quot; target=&quot;_blank&quot;&gt;Twitter&lt;/a&gt;&lt;/span&gt;
. Feel free leave a comment below!&lt;/p&gt;</content><author><name>Jeroen Mols</name></author><category term="android" /><category term="permissions" /><category term="modules" /><category term="manifest" /><category term="post-mortem" /><summary type="html">This is a post-mortem where the very dangerous permission, READ_PHONE_STATE, unintentionally sneaked into our app. Here‚Äôs how this could happen, how we debugged and finally how we solved it.</summary></entry><entry><title type="html">Pro Android Studio - Taming the interface</title><link href="https://jeroenmols.com/blog/2018/07/16/androidstudioshortcuts3/" rel="alternate" type="text/html" title="Pro Android Studio - Taming the interface" /><published>2018-07-16T00:00:00+02:00</published><updated>2018-07-16T00:00:00+02:00</updated><id>https://jeroenmols.com/blog/2018/07/16/androidstudioshortcuts3</id><content type="html" xml:base="https://jeroenmols.com/blog/2018/07/16/androidstudioshortcuts3/">&lt;p&gt;Not only can anything in Android Studio be controlled with a keyboard shortcut, it offers many more simple tricks to make you more productive.&lt;/p&gt;

&lt;p&gt;To conclude this series, we will look at how you can control the interface, invoke every (!) action and point you to even more advanced features.&lt;/p&gt;

&lt;blockquote&gt;

  &lt;p&gt;This post is part of a series with practical examples on how you to get the most out of Android Studio:&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;/blog/2018/02/22/androidstudioshortcuts/&quot;&gt;Part 1: Code navigation&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;/blog/2018/04/26/androidstudioshortcuts2/&quot;&gt;Part 2: Refactoring&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;/blog/2018/07/16/androidstudioshortcuts3/&quot;&gt;Part 3: Taming the interface&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;tldr&quot;&gt;TL;DR&lt;/h2&gt;
&lt;p&gt;I strongly suggest you look at the examples below, but a quick reference is always useful.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + number&lt;/code&gt;: open/close views&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ‚Üë&lt;/code&gt;: enlarge view&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ‚Üì&lt;/code&gt;: shrink view&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ‚Üí&lt;/code&gt;: enlarge side view&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ‚Üê&lt;/code&gt;: shrink side view&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + F12&lt;/code&gt;: close all views&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ]&lt;/code&gt;: next tab&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + [&lt;/code&gt;: previous tab&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;^ + ‚áß + ‚Üí&lt;/code&gt;: text view (xml layout editing)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;^ + ‚áß + ‚Üê&lt;/code&gt;: design view (visual layout editing)&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + letter&lt;/code&gt;: invoke button&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + ‚áß + A&lt;/code&gt;: action lookup&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;taming-the-interface&quot;&gt;Taming the interface&lt;/h2&gt;
&lt;p&gt;Using your keyboard is always more efficient than using a mouse. This is because you can make use of all your fingers at the same time + you don‚Äôt have to switch between mouse and keyboard.&lt;/p&gt;

&lt;p&gt;Wouldn‚Äôt it be cool if we never have to use our mouse again?&lt;/p&gt;

&lt;p&gt;First of all you can use &lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + number&lt;/code&gt; to open/close different Android Studio views (e.g. Logcat, Project view,‚Ä¶)&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts3/openviews.gif&quot; alt=&quot;Use `‚å• + number` to open/close different Android Studio views&quot; /&gt;
  &lt;figcaption&gt;Use `‚å• + number` to open/close different Android Studio views&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;You can shrink/enlarge the views above using &lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ‚Üë&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ‚Üì&lt;/code&gt; respectively,&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts3/expandshrinkviews.gif&quot; alt=&quot;Use `‚áß + ‚åò + ‚Üë` and `‚áß + ‚åò + ‚Üì` to shrink or enlarge views&quot; /&gt;
  &lt;figcaption&gt;Use `‚áß + ‚åò + ‚Üë` and `‚áß + ‚åò + ‚Üì` to shrink or enlarge views&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Note that this will also work with &lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ‚Üí&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ‚Üê&lt;/code&gt; for side views.&lt;/p&gt;

&lt;p&gt;Or close all views with &lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + F12&lt;/code&gt; to have a clutter free interface,&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts3/closeallviews.gif&quot; alt=&quot;Use `‚áß + ‚åò + F12` to close all views&quot; /&gt;
  &lt;figcaption&gt;Use `‚áß + ‚åò + F12` to close all views&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;When you have multiple tabs open, &lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + [&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ]&lt;/code&gt; come in handy to cycle between tabs.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts3/changetabs.gif&quot; alt=&quot;Use `‚áß + ‚åò + [` and `‚áß + ‚åò + ]` to cycle between tabs&quot; /&gt;
  &lt;figcaption&gt;Use `‚áß + ‚åò + [` and `‚áß + ‚åò + ]` to cycle between tabs&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;If you‚Äôre designing layouts, you can use &lt;code class=&quot;highlighter-rouge&quot;&gt;^ + ‚áß + ‚Üí&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;^ + ‚áß + ‚Üê&lt;/code&gt; to switch between design and text view.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts3/switchdesignxml.gif&quot; alt=&quot;Use `^ + ‚áß + ‚Üí` and `^ + ‚áß + ‚Üê` to switch between design and text view&quot; /&gt;
  &lt;figcaption&gt;Use `^ + ‚áß + ‚Üí` and `^ + ‚áß + ‚Üê` to switch between design and text view&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;And whenever you have a dialog open you can use &lt;code class=&quot;highlighter-rouge&quot;&gt;‚å•&lt;/code&gt; to highlight what letters you can press to invoke the respective buttons. E.g. in the example below &lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + R&lt;/code&gt; is used to press the replace button.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts3/controlinterface.gif&quot; alt=&quot;Use `‚å•` to highlight what letters you can press to invoke the respective buttons&quot; /&gt;
  &lt;figcaption&gt;Use `‚å•` to highlight what letters you can press to invoke the respective buttons&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Note that pressing &lt;code class=&quot;highlighter-rouge&quot;&gt;‚å•&lt;/code&gt; helps in a lot more situations such as in the find and replace window. (notice the subtle underline)&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts3/althighlighting.gif&quot; alt=&quot;Pressing `‚å•` reveals you can use `‚å• + p` to replace the next occurrence&quot; /&gt;
  &lt;figcaption&gt;Pressing `‚å•` reveals you can use `‚å• + p` to replace the next occurrence&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;shortcut-lookup&quot;&gt;Shortcut lookup&lt;/h2&gt;
&lt;p&gt;If there is one shortcut you should really remember, then that is &lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + ‚áß + A&lt;/code&gt;. That one allows you to invoke any Android Studio action using your keyboard.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts3/searchactions.gif&quot; alt=&quot;Use `‚åò + ‚áß + A` to search for any action.&quot; /&gt;
  &lt;figcaption&gt;Use `‚åò + ‚áß + A` to search for any action.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Note that this also serves as a useful shortcut lookup tool. Next to every action the corresponding shortcut will be displayed (if there is one).&lt;/p&gt;

&lt;h2 id=&quot;additional-reads&quot;&gt;Additional reads&lt;/h2&gt;
&lt;p&gt;Android Studio is incredibly powerful and hence this blog post series couldn‚Äôt cover everything. However, if I piqued your interest, have a look at these references:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://kevinpelgrims.com/blog/2017/12/29/using-multicursor-in-android-studio/&quot;&gt;Using multicursor in Android studio&lt;/a&gt; by Kevin Pelgrims&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://medium.com/@geapi/permanent-function-keys-intellij-macbook-pro-w-touchbar-d6fc78781b90&quot;&gt;Permantent function keys in Android Studio with Macbook pro Touchbar&lt;/a&gt; By Georg Apitz&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://afterecho.uk/blog/structural-search-and-replace-in-android-studio.html&quot;&gt;Structural search and replace&lt;/a&gt; by Darren&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://medium.com/google-developers/writing-more-code-by-writing-less-code-with-android-studio-live-templates-244f648d17c7&quot;&gt;Android studio live templates&lt;/a&gt; by Retro Meier&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.vojtechruzicka.com/intellij-idea-tips-tricks-postfix-code-completion/&quot;&gt;Postfix code completion&lt;/a&gt; by Vojtech Ruzicka‚Äôs&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;wrap-up&quot;&gt;Wrap up&lt;/h2&gt;
&lt;p&gt;Investing time to really learn Android Studio can mean a big productivity boost. Start with &lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + ‚áß + A&lt;/code&gt;, learn the corresponding shortcuts and challenge yourself to use your mouse less.&lt;/p&gt;

&lt;p&gt;This was the last part in my series to get the most out of Android Studio.&lt;/p&gt;

&lt;p&gt;If you‚Äôve made it this far you should probably follow me on &lt;span&gt;&lt;a href=&quot;https://twitter.com/molsjeroen?source=proandroidstudio-tamingtheinterface2018&quot; class=&quot;ga-link&quot; target=&quot;_blank&quot;&gt;Twitter&lt;/a&gt;&lt;/span&gt;
. Feel free leave a comment below!&lt;/p&gt;</content><author><name>Jeroen Mols</name></author><category term="androidstudio" /><category term="tools" /><category term="shortcuts" /><category term="navigation" /><summary type="html">Not only can anything in Android Studio be controlled with a keyboard shortcut, it offers many more simple tricks to make you more productive.</summary></entry><entry><title type="html">Pro Android Studio - Refactoring</title><link href="https://jeroenmols.com/blog/2018/04/26/androidstudioshortcuts2/" rel="alternate" type="text/html" title="Pro Android Studio - Refactoring" /><published>2018-04-26T00:00:00+02:00</published><updated>2018-04-26T00:00:00+02:00</updated><id>https://jeroenmols.com/blog/2018/04/26/androidstudioshortcuts2</id><content type="html" xml:base="https://jeroenmols.com/blog/2018/04/26/androidstudioshortcuts2/">&lt;p&gt;Refactoring can be tedious and easily introduce bugs. The main reason for this is the number of manual steps involved: rename, move, copy-paste,‚Ä¶ So wouldn‚Äôt it make sense to automate this and have Android Studio do all the work for you?&lt;/p&gt;

&lt;p&gt;This post will zoom in on the most useful refactoring options of Android Studio. Enabling you to refactor more confidently, introduce fewer bugs and increase overall quality as also variables, documentation, etc. will be updated.&lt;/p&gt;

&lt;blockquote&gt;

  &lt;p&gt;This post is part of a series with practical examples on how you to get the most out of Android Studio:&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;/blog/2018/02/22/androidstudioshortcuts/&quot;&gt;Part 1: Code navigation&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;/blog/2018/04/26/androidstudioshortcuts2/&quot;&gt;Part 2: Refactoring&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;/blog/2018/07/16/androidstudioshortcuts3/&quot;&gt;Part 3: Taming the interface&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;tldr&quot;&gt;TL;DR&lt;/h2&gt;
&lt;p&gt;I strongly suggest you look at the examples below, but a quick reference is always useful.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + D&lt;/code&gt;: duplicate line&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + backspace&lt;/code&gt;: delete line&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + ‚Üë&lt;/code&gt;: move line up&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + ‚Üì&lt;/code&gt;: move line down&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ‚Üë&lt;/code&gt;: move method up&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ‚Üì&lt;/code&gt;: move method down&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + F6&lt;/code&gt;: rename&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + F6&lt;/code&gt;: change method signature&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;F6&lt;/code&gt;: move&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + ‚åò + V&lt;/code&gt;: extract variable&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + ‚åò + M&lt;/code&gt;: extract method&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + ‚åò + P&lt;/code&gt;: extract method parameter&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + ‚åò + F&lt;/code&gt;: extract property (or field)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + ‚åò + C&lt;/code&gt;: extract constant (java only)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + ‚åò + N&lt;/code&gt;: inline&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;^ + T&lt;/code&gt;: open refactoring menu&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + enter&lt;/code&gt;: quick fix&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Windows equivalents can be found &lt;a href=&quot;https://developer.android.com/studio/intro/keyboard-shortcuts.html&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;code-manipulation&quot;&gt;Code manipulation&lt;/h2&gt;
&lt;p&gt;In order to speed up development, you want to reduce the amount of typing to a minimum. While autocomplete definitely helps, sometimes it‚Äôs faster to directly manipulate lines:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + D&lt;/code&gt;: duplicate line&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + backspace&lt;/code&gt;: delete line&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These shortcuts will work regardless of the cursor position in the line.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/duplicatedelete.gif&quot; alt=&quot;Duplicate and delete lines&quot; /&gt;
  &lt;figcaption&gt;Duplicate and delete lines&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;After duplicating you can simply move code up/down by using &lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + ‚Üë&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + ‚Üì&lt;/code&gt; for lines, or &lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ‚Üë&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + ‚åò + ‚Üì&lt;/code&gt; for methods.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/movelineblock.gif&quot; alt=&quot;Move lines and methods up/down&quot; /&gt;
  &lt;figcaption&gt;Move lines and methods up/down&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Both combined provide a powerful way of extending code: you duplicate a line, edit it and move it to its location.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/editlines.gif&quot; alt=&quot;Quick edit lines via duplicate and move&quot; /&gt;
  &lt;figcaption&gt;Quick edit lines via duplicate and move&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;rename-update-and-move&quot;&gt;Rename, update and move&lt;/h2&gt;
&lt;p&gt;Renaming classes is very involved: rename class definition, rename the file and update all references and documentation. Fortunately &lt;code class=&quot;highlighter-rouge&quot;&gt;‚áß + F6&lt;/code&gt; does all of that for you.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/renameclass.gif&quot; alt=&quot;Rename anything with ‚áß + F6&quot; /&gt;
  &lt;figcaption&gt;Rename anything with ‚áß + F6&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;This doesn‚Äôt just work for classes, but also for methods, variables, fields,‚Ä¶&lt;/p&gt;

&lt;p&gt;Similarly &lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + F6&lt;/code&gt; allows you to update the signature of a method. This is especially useful to add, remove or reorder new parameters to the method definition.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/changesignature.gif&quot; alt=&quot;Change method signature with ‚åò + F6&quot; /&gt;
  &lt;figcaption&gt;Change method signature with ‚åò + F6&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Note how you can specify a default value so all existing method consumers will be updated by Android Studio! Use &lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + ‚Üë&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;‚åò + ‚Üì&lt;/code&gt; to quickly reorder parameters.&lt;/p&gt;

&lt;p&gt;Finally, you can move classes to their own file or to another package using &lt;code class=&quot;highlighter-rouge&quot;&gt;F6&lt;/code&gt;. This works for all top-level declarations and Java static methods/constants.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/moveclass.gif&quot; alt=&quot;Move classes with F6&quot; /&gt;
  &lt;figcaption&gt;Move classes with F6&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;refactoring&quot;&gt;Refactoring&lt;/h2&gt;
&lt;p&gt;To clean up code it is often handy to convert values into variables with a meaningful name. This is easy using &lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + ‚åò + V&lt;/code&gt;.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/extractvariable.gif&quot; alt=&quot;Extract variable with ‚å• + ‚åò + V&quot; /&gt;
  &lt;figcaption&gt;Extract variable with ‚å• + ‚åò + V&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Note that you can either replace one or all occurrences.&lt;/p&gt;

&lt;p&gt;Similarly, you can extract code into a method with &lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + ‚åò + M&lt;/code&gt; and give it an easy to understand name.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/extractmethod.gif&quot; alt=&quot;Extract method with ‚å• + ‚åò + M&quot; /&gt;
  &lt;figcaption&gt;Extract method with ‚å• + ‚åò + M&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;You can even convert a variable to a parameter that is injected into the method using &lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + ‚åò + P&lt;/code&gt;.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/extractparameter.gif&quot; alt=&quot;Extract parameter with ‚å• + ‚åò + P&quot; /&gt;
  &lt;figcaption&gt;Extract parameter with ‚å• + ‚åò + P&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;If this makes another parameter obsolete, then it will be automatically removed from the method signature.&lt;/p&gt;

&lt;p&gt;Same holds true to create properties, by using &lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + ‚åò + F&lt;/code&gt;.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/extractproperty.gif&quot; alt=&quot;Extract property with ‚å• + ‚åò + F&quot; /&gt;
  &lt;figcaption&gt;Extract property with ‚å• + ‚åò + F&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Note that for Java you can also use &lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + ‚åò + C&lt;/code&gt; to extract a static final field. This isn‚Äôt available for Kotlin however.&lt;/p&gt;

&lt;p&gt;Besides extracting, you can also do the inverse operation: inlining &lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + ‚åò + N&lt;/code&gt;. This is available for almost everything you can extract: methods, variables, properties,‚Ä¶&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/inlinevariablesmethods.gif&quot; alt=&quot;Inline method or variable with ‚å• + ‚åò + N&quot; /&gt;
  &lt;figcaption&gt;Inline method or variable with ‚å• + ‚åò + N&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Inlining gives you the option to inline it only in one place or everywhere. Plus you can optionally still keep the inlined variable or method.&lt;/p&gt;

&lt;p&gt;While the above refactorings are the most commonly used ones, Android Studio actually offers quite a lot more if you press &lt;code class=&quot;highlighter-rouge&quot;&gt;^ + T&lt;/code&gt;:&lt;/p&gt;

&lt;figure style=&quot;width: 50%&quot; class=&quot;align-center&quot;&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/refactoroptions.png&quot; alt=&quot;All refactoring options&quot; /&gt;
  &lt;figcaption&gt;All refactoring options&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;I strongly encourage you to experiment with these and learn how they work. Good knowledge of these can dramatically speed up your development and reduce mistakes.&lt;/p&gt;

&lt;h2 id=&quot;android-studio-quick-fixes&quot;&gt;Android studio quick fixes&lt;/h2&gt;
&lt;p&gt;With &lt;code class=&quot;highlighter-rouge&quot;&gt;‚å• + enter&lt;/code&gt; Android Studio is able to quickly fix a number of common issues: add imports, remove unused method, remove unused parameter, restrict access modifiers,‚Ä¶&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/quickfixes.gif&quot; alt=&quot;Quick fix problems with ‚å• + enter&quot; /&gt;
  &lt;figcaption&gt;Quick fix problems with ‚å• + enter&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;This quick fix option is significantly more powerful than you might think. Have a look at the function below:&lt;/p&gt;

&lt;div class=&quot;language-kotlin highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shouldFollowAuthorOnTwitter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isBadBlogPost&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Boolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hasReadArticle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Boolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Boolean&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;py&quot;&gt;isBlogJeroen&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isBlogJeroen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isBadBlogPost&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hasReadArticle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Not easy to understand, is it?&lt;/p&gt;

&lt;p&gt;Let‚Äôs now use Android Studio to simplify this complex code for us.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://jeroenmols.com/img/blog/androidstudioshortcuts2/simplifyifs.gif&quot; alt=&quot;Simplify if statements&quot; /&gt;
  &lt;figcaption&gt;Simplify if statements&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Pretty cool, no?&lt;/p&gt;

&lt;p&gt;Even better: this procedure is 100% safe!!! This is because we‚Äôve offloaded all correctness checks and code changes to our IDE.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;If you‚Äôre interested in the next posts it‚Äôs probably best to follow me on &lt;span&gt;&lt;a href=&quot;https://twitter.com/molsjeroen?source=proandroidstudio-refactoring2018&quot; class=&quot;ga-link&quot; target=&quot;_blank&quot;&gt;Twitter&lt;/a&gt;&lt;/span&gt;
.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;wrap-up&quot;&gt;Wrap up&lt;/h2&gt;
&lt;p&gt;Refactoring can be tedious and easily introduce bugs. Therefore we should automate as much as we can using Android Studio.&lt;/p&gt;

&lt;p&gt;This was part two of my series to get the most out of Android Studio.&lt;/p&gt;

&lt;p&gt;If you‚Äôve made it this far you should probably follow me on &lt;span&gt;&lt;a href=&quot;https://twitter.com/molsjeroen?source=proandroidstudio-refactoring2018&quot; class=&quot;ga-link&quot; target=&quot;_blank&quot;&gt;Twitter&lt;/a&gt;&lt;/span&gt;
. Feel free leave a comment below!&lt;/p&gt;</content><author><name>Jeroen Mols</name></author><category term="androidstudio" /><category term="tools" /><category term="shortcuts" /><summary type="html">Refactoring can be tedious and easily introduce bugs. The main reason for this is the number of manual steps involved: rename, move, copy-paste,‚Ä¶ So wouldn‚Äôt it make sense to automate this and have Android Studio do all the work for you?</summary></entry></feed>