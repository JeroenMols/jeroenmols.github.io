<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.2.2 by Michael Rose
  Copyright 2017 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
 <head>
   <meta charset="utf-8">
<title>Using Mockito 2.x on Android - Jeroen Mols</title>
<meta name="description" content="The Mockito team is on fire lately! Not only did they add support to mock final classes and methods, but now they allow running Mockito directly onto an actual Android device.">
<meta name="author" content="Jeroen Mols">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="Jeroen Mols">
<meta property="og:title" content="Using Mockito 2.x on Android">
<link rel="canonical" href="https://jeroenmols.com/blog/2017/01/17/mockitoandroid/">
 <meta property="og:url" content="https://jeroenmols.com/blog/2017/01/17/mockitoandroid/">
 <meta property="og:description" content="The Mockito team is on fire lately! Not only did they add support to mock final classes and methods, but now they allow running Mockito directly onto an actual Android device.">
 <meta name="twitter:site" content="@molsjeroen">
 <meta name="twitter:title" content="Using Mockito 2.x on Android">
 <meta name="twitter:description" content="The Mockito team is on fire lately! Not only did they add support to mock final classes and methods, but now they allow running Mockito directly onto an actual Android device.">
 <meta name="twitter:url" content="https://jeroenmols.com/blog/2017/01/17/mockitoandroid/">
   <meta name="twitter:card" content="summary_large_image">
   <meta name="twitter:image" content="https://jeroenmols.com/img/blog/mockitoandroid/mockitoandroid.png">
   <meta name="twitter:creator" content="@Jeroen Mols">
 <meta property="og:image" content="https://jeroenmols.com/img/blog/mockitoandroid/mockitoandroid.png">
 <meta property="og:type" content="article">
 <meta property="article:published_time" content="2017-01-17T00:00:00+01:00">
  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Jeroen Mols",
      "url" : "https://jeroenmols.com",
      "sameAs" : ["https://twitter.com/molsjeroen","https://www.linkedin.com/in/jeroenmols/","https://plus.google.com/+JeroenMols","https://github.com/JeroenMols","https://speakerdeck.com/jeroenmols","https://stackoverflow.com/users/2771851/jmols"]
    }
  </script>
 <meta name="google-site-verification" content="8E8HUpExgyNFdLuFMWmkSUl08gISnOF3UWexA55aNrk" />
<link href="atom.xml" type="application/atom+xml" rel="alternate" title="Jeroen Mols Feed">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>
<link rel="stylesheet" href="https://jeroenmols.com/assets/css/main.css">
<!--[if lte IE 9]>
 <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
 </style>
<![endif]-->
<meta http-equiv="cleartype" content="on">
 </head>
 <body class="layout--single">
    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
   <meta name="theme-color" content="#2c3e50">
<div class="masthead">
 <div class="masthead__inner-wrap">
   <div class="masthead__menu">
     <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="https://jeroenmols.com/">Jeroen Mols</a>
       <ul class="visible-links">
           <li class="masthead__menu-item"><a href="https://jeroenmols.com/blog/">Blog</a></li>
           <li class="masthead__menu-item"><a href="https://jeroenmols.com/speaking/">Speaking</a></li>
           <li class="masthead__menu-item"><a href="https://jeroenmols.com/hireme/">Hire me</a></li>
       </ul>
        <button><div class="navicon"></div></button>
       <ul class="hidden-links hidden"></ul>
     </nav>
   </div>
 </div>
</div>
<div id="main" role="main">
 <div class="sidebar sticky">
<div itemscope itemtype="http://schema.org/Person">
   <div class="author__avatar">
        <img src="https://jeroenmols.com/img/profile.jpg" class="author__avatar" alt="Jeroen Mols" itemprop="image">
   </div>
 <div class="author__content">
   <h3 class="author__name" itemprop="name">Jeroen Mols</h3>
     <p class="author__bio" itemprop="description">
        Android GDE & Lead Android developer at Philips Hue
     </p>
 </div>
 <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
   <ul class="author__urls social-icons">
       <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> <span itemprop="name">Mol, Belgium</span>
       </li>
       <li>
          <a href="https://twitter.com/@molsjeroen" itemprop="sameAs">
            <i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
       </li>
       <li>
          <a href="https://plus.google.com/+JeroenMols" itemprop="sameAs">
            <i class="fa fa-fw fa-google-plus-square" aria-hidden="true"></i> Google+
          </a>
       </li>
       <li>
          <a href="https://www.linkedin.com/in/jeroenmols" itemprop="sameAs">
            <i class="fa fa-fw fa-linkedin-square" aria-hidden="true"></i> LinkedIn
          </a>
       </li>
       <li>
          <a href="https://github.com/JeroenMols" itemprop="sameAs">
            <i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
       </li>
       <li>
          <a href="https://www.stackoverflow.com/users/2771851/jmols" itemprop="sameAs">
            <i class="fa fa-fw fa-stack-overflow" aria-hidden="true"></i> Stackoverflow
          </a>
       </li>
         <li>
            <a href="https://www.youtube.com/channel/UC34Vt1lo8T15_rgc3e3Jsew" itemprop="sameAs">
              <i class="fa fa-fw fa-youtube-square" aria-hidden="true"></i> YouTube
            </a>
         </li>
 <li>
    <a href="https://speakerdeck.com/jeroenmols" itemprop="sameAs">
      <i class="fa fa-line-chart" aria-hidden="true"></i> Speaker Deck
    </a>
 </li>
   </ul>
 </div>
</div>
 </div>
 <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
   <meta itemprop="headline" content="Using Mockito 2.x on Android">
   <meta itemprop="description" content="The Mockito team is on fire lately! Not only did they add support to mock final classes and methods, but now they allow running Mockito directly onto an actual Android device.">
   <meta itemprop="datePublished" content="January 17, 2017">
   <div class="page__inner-wrap">
      <header>
         <h1 class="page__title" itemprop="headline">Using Mockito 2.x on Android
</h1>
         <p class="page__meta"><i class="fa fa-fw fa-calendar" aria-hidden="true"></i>  17 Jan 2017</p>
            <img src="https://jeroenmols.com/img/blog/mockitoandroid/mockitoandroid.png" alt="Using Mockito 2.x on Android" title="Android logo by Google, https://creativecommons.org/licenses/by/3.0/, cropped. Mockito logo, https://github.com/mockito/mockito, unmodified.">
           <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 
  1 minute read
</p>
       </header>
     <section class="page__content" itemprop="text">
       <p>The Mockito team is on fire lately! Not only did they add support to mock final classes and methods, but now they allow running Mockito directly onto an actual Android device.</p>

<p>Time to convert our Mockito 1.x projects to 2.x!</p>

<h2 id="history">History</h2>
<p>It has always been possible to run Mockito on Android devices and emulators. This however required using a tool called <code class="highlighter-rouge">Dexmaker</code> to help Mockito generate classes in the Android virtual machine.</p>

<p>While this approach worked fine, there was one big caveat: <code class="highlighter-rouge">Dexmaker</code> wasn’t actively maintained. Consequently it was only compatible with Mockito 1.x so you couldn’t use the new stuff while running tests on an Android device.</p>

<p>Further this extra dependency made your <code class="highlighter-rouge">build.gradle</code> look like this:</p>

<div class="language-groovy highlighter-rouge"><pre class="highlight"><code><span class="n">dependencies</span> <span class="o">{</span>
    <span class="o">...</span>

    <span class="n">testCompile</span> <span class="s1">'org.mockito:mockito-core:2.6.3'</span>

    <span class="n">androidTestCompile</span> <span class="s1">'org.mockito:mockito-core:1.10.19'</span>
    <span class="n">androidTestCompile</span> <span class="s1">'com.crittercism.dexmaker:dexmaker:1.4'</span>
    <span class="n">androidTestCompile</span> <span class="s1">'com.crittercism.dexmaker:dexmaker-dx:1.4'</span>
    <span class="n">androidTestCompile</span> <span class="s1">'com.crittercism.dexmaker:dexmaker-mockito:1.4'</span>
<span class="o">}</span>
</code></pre>
</div>

<p>Notice the 2.x version for the unit tests and the 1.x version for the instrumentation tests.</p>

<p>Fortunately, Mockito 2.6.0 changed that:</p>

<center><blockquote class="twitter-tweet" data-lang="nl"><p lang="en" dir="ltr">We have just released Mockito 2.6 with native support for Android. On Android, just use the mockito-android dependency. Test code stays!</p>&mdash; Rafael Winterhalter (@rafaelcodes) <a href="https://twitter.com/rafaelcodes/status/819525418231496705">12 januari 2017</a></blockquote></center>

<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<h2 id="mockito-260">Mockito 2.6.0+</h2>
<p>The latest release added a new artifact <code class="highlighter-rouge">mockito-android</code> next to the existing <code class="highlighter-rouge">mockito-core</code> artifact.</p>

<p>So to convert your existing instrumentation tests, just remove the <code class="highlighter-rouge">Dexmaker</code> dependencies and replace the <code class="highlighter-rouge">mockito-core</code> dependency with its <code class="highlighter-rouge">mockito-android</code> equivalent:</p>

<div class="language-groovy highlighter-rouge"><pre class="highlight"><code><span class="n">dependencies</span> <span class="o">{</span>
    <span class="o">...</span>

    <span class="n">testCompile</span> <span class="s1">'org.mockito:mockito-core:2.6.3'</span>

    <span class="n">androidTestCompile</span> <span class="s1">'org.mockito:mockito-android:2.6.3'</span>
<span class="o">}</span>
</code></pre>
</div>

<p>Simple, elegant and future proof!</p>

<p>Finally, please be aware that Mockito 2.x has some <a href="https://github.com/mockito/mockito/wiki/What%27s-new-in-Mockito-2#incompatible">behavior changes</a>. The one you’re most likely going to run into while migrating is that <code class="highlighter-rouge">anyX()</code> and <code class="highlighter-rouge">any(SomeType.class)</code> matchers now reject null values.</p>

<h2 id="wrap-up">Wrap-up</h2>
<p>Finally Mockito has first class support for Android instrumentation tests! I’ve also updated my <a href="https://github.com/jeroenmols/mockitoexample">Mockito sample project</a> where you can see how it works and learn more about how to use Mockito.</p>

<p>As always you can reach me <a href="https://twitter.com/molsjeroen">@molsjeroen</a> on twitter, or leave a comment below!</p>

     </section>
     <footer class="page__meta">
 <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
      <a href="https://jeroenmols.com/tags/android" class="page__taxonomy-item" rel="tag">android</a><span class="sep">, </span>
      <a href="https://jeroenmols.com/tags/mockito" class="page__taxonomy-item" rel="tag">mockito</a><span class="sep">, </span>
      <a href="https://jeroenmols.com/tags/testing" class="page__taxonomy-item" rel="tag">testing</a>
    </span>
 </p>
 <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
      <a href="https://jeroenmols.com/categories/blog" class="page__taxonomy-item" rel="tag">blog</a>
    </span>
 </p>
         <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-01-17T00:00:00+01:00">January 17, 2017</time></p>
     </footer>
     <section class="page__share">
   <h4 class="page__share-title">Share on</h4>
  <a href="https://twitter.com/intent/tweet?via=molsjeroen&text=Using Mockito 2.x on Android https://jeroenmols.com/blog/2017/01/17/mockitoandroid/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>
  <a href="https://www.facebook.com/sharer/sharer.php?u=https://jeroenmols.com/blog/2017/01/17/mockitoandroid/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>
  <a href="https://plus.google.com/share?url=https://jeroenmols.com/blog/2017/01/17/mockitoandroid/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>
  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://jeroenmols.com/blog/2017/01/17/mockitoandroid/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>
     <section class="page__share">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-9854541518226004"
       data-ad-slot="4086741379"
       data-ad-format="auto"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</section>

 <nav class="pagination">
      <a href="https://jeroenmols.com/blog/2017/01/09/yearinreview/" class="pagination--pager" title="Year in review 2016
">Previous</a>
      <a href="https://jeroenmols.com/blog/2017/02/16/unittests/" class="pagination--pager" title="Write awesome unit tests
">Next</a>
 </nav>
   </div>
     <div class="page__comments">
       <h4 class="page__comments-title">Leave a Comment</h4>
       <section id="disqus_thread"></section>
</div>
 </article>
   <div class="page__related">
     <h4 class="page__related-title">You May Also Enjoy</h4>
     <div class="grid__wrapper">
     </div>
   </div>
</div>
   <div class="page__footer">
     <footer>
       <div class="page__footer-follow">
 <ul class="social-icons">
     <li><strong>Follow:</strong></li>
     <li><a href="https://twitter.com/molsjeroen"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
     <li><a href="http://github.com/JeroenMols"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
   <li><a href="atom.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
 </ul>
</div>
<div class="page__footer-copyright">&copy; 2017 Jeroen Mols. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
     </footer>
   </div>
    <script src="https://jeroenmols.com/assets/js/main.min.js"></script>
  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-63356566-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'jeroenmols';
  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();
  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
 </body>
</html>
